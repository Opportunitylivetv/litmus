C C-PaulEMcKenney-SB+adat-o+adat-o.litmus

(* Expected result: Never.  The atomic_dec_and_test() primitive is
 * supposed to provide full ordering. *)

{
	x=1;
	y=2;
}

P0(atomic_t *x, atomic_t *y)
{
	int r1;
	int r2;

	r1 = atomic_dec_and_test(&x);
	r2 = atomic_read(&y);
}

P1(atomic_t *x, atomic_t *y)
{
	int r1;
	int r2;

	r1 = atomic_dec_and_test(&y);
	r2 = atomic_read(&x);
}

exists
(x!=0 \/ y!=1 \/ 0:r1!=1 \/ 1:r1!=0 \/ (0:r2==2 /\ 1:r2==1))
